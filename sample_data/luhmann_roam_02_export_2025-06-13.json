{
  "metadata": {
    "exportedAt": "2025-06-13T21:35:42.331Z",
    "version": "1.0",
    "exportType": "enhanced_code_graph_project",
    "originalProject": {
      "id": "proj_1749561512961_39d4z8qrn",
      "name": "luhmann-roam-02",
      "path": "controllers/dcimController.js",
      "description": "Imported from: Comprehensive Digital Camera Image Management Controller - Full dcimController.js and dcimRoutes.js analysis",
      "language": "javascript",
      "framework": "Express.js",
      "tags": [
        "template",
        "dcim",
        "image-processing",
        "file-management",
        "imported",
        "template"
      ],
      "status": "active"
    },
    "statistics": {
      "function_count": 33,
      "variable_count": 28,
      "dependency_count": 60,
      "relationship_types": [
        "contains",
        "passes_to",
        "chains_to",
        "assigns_to",
        "calls_method_on",
        "calls",
        "controls_flow_to",
        "derives_from"
      ]
    }
  },
  "template": {
    "name": "luhmann-roam-02_Export_1749850542331",
    "display_name": "luhmann-roam-02 - Exported Structure",
    "description": "Exported project structure from: Imported from: Comprehensive Digital Camera Image Management Controller - Full dcimController.js and dcimRoutes.js analysis",
    "functions": [
      {
        "name": "addImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 156,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Add new image with file upload and thumbnail generation",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "addSubsidiaryImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 634,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Add new subsidiary image with metadata inheritance",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "convertImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 436,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Convert existing image to WebP format",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "convertToWebP",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 110,
        "end_line_number": null,
        "parameters": [
          "imagePath",
          "outputPath",
          "quality"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Convert image to WebP format using Sharp",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "convertUploadedImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 520,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Convert uploaded image to optimized WebP format",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "deleteImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 322,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Delete image with file cleanup and subsidiary handling",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "ffmpeg",
        "full_name": null,
        "file_path": "ffmpeg-fluent (Node.js module)",
        "line_number": 76,
        "end_line_number": null,
        "parameters": [
          "inputPath"
        ],
        "return_type": "FFmpegCommand",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "FFmpeg fluent API constructor for video processing",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "ffmpeg.on",
        "full_name": null,
        "file_path": "ffmpeg-fluent (Node.js module)",
        "line_number": 83,
        "end_line_number": null,
        "parameters": [
          "event",
          "callback"
        ],
        "return_type": "FFmpegCommand",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Attach event listener to FFmpeg command",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "ffmpeg.screenshots",
        "full_name": null,
        "file_path": "ffmpeg (Node.js module)",
        "line_number": null,
        "end_line_number": null,
        "parameters": [
          "options"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "FFmpeg video frame extraction",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "formatFileSize",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 120,
        "end_line_number": null,
        "parameters": [
          "size"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Format file size in bytes to human-readable format",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "fs.existsSync",
        "full_name": null,
        "file_path": "fs (Node.js module)",
        "line_number": null,
        "end_line_number": null,
        "parameters": [
          "path"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Synchronously check if file exists",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "fs.unlinkSync",
        "full_name": null,
        "file_path": "fs (Node.js module)",
        "line_number": 91,
        "end_line_number": null,
        "parameters": [
          "path"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Synchronously delete file from filesystem",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "generateThumbnail",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 68,
        "end_line_number": null,
        "parameters": [
          "inputPath",
          "thumbPath",
          "maxSize",
          "quality"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Generate thumbnails for images and videos using Sharp and FFmpeg",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "getAssetDirectory",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 25,
        "end_line_number": null,
        "parameters": [],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Retrieves custom asset directory path from database with fallback",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "getImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 139,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Retrieve single image by ID for detailed view",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "getImages",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 125,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Retrieve all images from database for gallery view",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "getSubsidiaryImages",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 610,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Get all subsidiary images for a parent image",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "getThumbnailDirectory",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 45,
        "end_line_number": null,
        "parameters": [],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Retrieves custom thumbnail directory path from database with fallback",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "includes",
        "full_name": null,
        "file_path": "built-in",
        "line_number": 71,
        "end_line_number": null,
        "parameters": [
          "searchElement"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "JavaScript built-in array method to check if element exists",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "multer.diskStorage",
        "full_name": null,
        "file_path": "routes/dcimRoutes.js",
        "line_number": 8,
        "end_line_number": null,
        "parameters": [
          "options"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Configure multer disk storage for file uploads",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "new Promise",
        "full_name": null,
        "file_path": "built-in",
        "line_number": 75,
        "end_line_number": null,
        "parameters": [
          "executor"
        ],
        "return_type": "Promise",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "JavaScript built-in Promise constructor",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "path.dirname",
        "full_name": null,
        "file_path": "path (Node.js module)",
        "line_number": 85,
        "end_line_number": null,
        "parameters": [
          "path"
        ],
        "return_type": "string",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Extract directory path from file path",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "path.extname",
        "full_name": null,
        "file_path": "path (Node.js module)",
        "line_number": null,
        "end_line_number": null,
        "parameters": [
          "path"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Extract file extension from path",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "path.join",
        "full_name": null,
        "file_path": "path (Node.js module)",
        "line_number": 85,
        "end_line_number": null,
        "parameters": [
          "segments"
        ],
        "return_type": "string",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Join path segments into a complete path",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "router.get",
        "full_name": null,
        "file_path": "routes/dcimRoutes.js",
        "line_number": 40,
        "end_line_number": null,
        "parameters": [
          "path",
          "handler"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Express GET route registration",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "router.post",
        "full_name": null,
        "file_path": "routes/dcimRoutes.js",
        "line_number": 50,
        "end_line_number": null,
        "parameters": [
          "path",
          "middleware",
          "handler"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Express POST route registration with middleware",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "sharp",
        "full_name": null,
        "file_path": "sharp (Node.js module)",
        "line_number": null,
        "end_line_number": null,
        "parameters": [
          "input"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Sharp image processing library constructor",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "sharp.resize",
        "full_name": null,
        "file_path": "sharp (Node.js module)",
        "line_number": 86,
        "end_line_number": null,
        "parameters": [
          "options"
        ],
        "return_type": "Sharp",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Resize image with specified dimensions and fit options",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "sharp.toFile",
        "full_name": null,
        "file_path": "sharp (Node.js module)",
        "line_number": 88,
        "end_line_number": null,
        "parameters": [
          "outputPath"
        ],
        "return_type": "Promise",
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Save processed image to file and return Promise",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "sharp.webp",
        "full_name": null,
        "file_path": "sharp (Node.js module)",
        "line_number": 87,
        "end_line_number": null,
        "parameters": [
          "options"
        ],
        "return_type": "Sharp",
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Convert image to WebP format with quality settings",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "toLowerCase",
        "full_name": null,
        "file_path": "built-in",
        "line_number": 70,
        "end_line_number": null,
        "parameters": [],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "JavaScript built-in string method to convert to lowercase",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "updateImage",
        "full_name": null,
        "file_path": "controllers/dcimController.js",
        "line_number": 270,
        "end_line_number": null,
        "parameters": [
          "req",
          "res"
        ],
        "return_type": null,
        "is_async": 1,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Update existing image metadata",
        "tags": [],
        "metadata": {}
      },
      {
        "name": "upload.single",
        "full_name": null,
        "file_path": "routes/dcimRoutes.js",
        "line_number": 50,
        "end_line_number": null,
        "parameters": [
          "fieldName"
        ],
        "return_type": null,
        "is_async": 0,
        "is_static": 0,
        "is_private": 0,
        "complexity_score": 1,
        "description": "Multer middleware for single file upload",
        "tags": [],
        "metadata": {}
      }
    ],
    "variables": [
      {
        "name": "DEFAULT_ASSET_DIR",
        "type": "string",
        "value": "path.join(__dirname, '../public/attachment/dcim')",
        "file_path": "unknown.js",
        "line_number": 10,
        "scope": "global",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "DEFAULT_THUMB_DIR",
        "type": "string",
        "value": "path.join(__dirname, '../public/attachment/thumbnails')",
        "file_path": "unknown.js",
        "line_number": 11,
        "scope": "global",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "Promise",
        "type": "constructor",
        "value": "new Promise((resolve, reject) => {...})",
        "file_path": "controllers/dcimController.js",
        "line_number": 75,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Promise constructor for wrapping FFmpeg callback API",
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "THUMBNAIL_SIZE",
        "type": "number",
        "value": "180",
        "file_path": "unknown.js",
        "line_number": 9,
        "scope": "global",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "allowedTypes",
        "type": "regexp",
        "value": "/jpeg|jpg|png|gif|webp|mp4|mov|avi|mkv|webm/",
        "file_path": "unknown.js",
        "line_number": 25,
        "scope": "literal",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "db",
        "type": "object",
        "value": "Database connection object from getDb()",
        "file_path": "unknown.js",
        "line_number": 130,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "getImages"
      },
      {
        "name": "endCallback",
        "type": "function",
        "value": "() => { /* Sharp processing logic */ }",
        "file_path": "controllers/dcimController.js",
        "line_number": 83,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Callback function executed when ffmpeg completes",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "errorCallback",
        "type": "function",
        "value": "reject",
        "file_path": "controllers/dcimController.js",
        "line_number": 96,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Error callback function for ffmpeg failures",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "fileExtension",
        "type": "string",
        "value": "const fileExtension - extracted and lowercased file extension",
        "file_path": "unknown.js",
        "line_number": 70,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "filename",
        "type": "string",
        "value": "'temp-frame.png'",
        "file_path": "controllers/dcimController.js",
        "line_number": 78,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Output filename for extracted video frame",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "folder",
        "type": "string",
        "value": "path.dirname(thumbPath)",
        "file_path": "controllers/dcimController.js",
        "line_number": 79,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Directory path where extracted frame will be saved",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "images",
        "type": "array",
        "value": "Array of image records from database query",
        "file_path": "unknown.js",
        "line_number": 132,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "getImages"
      },
      {
        "name": "inputPath",
        "type": "string",
        "value": "function parameter - source file path for thumbnail generation",
        "file_path": "unknown.js",
        "line_number": 68,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "isVideo",
        "type": "boolean",
        "value": "",
        "file_path": "controllers/dcimController.js",
        "line_number": 70,
        "scope": "local",
        "declaration_type": "",
        "mutability": "mutable",
        "is_exported": 0,
        "description": "const isVideo - boolean indicating if file is video format",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "maxSize",
        "type": "number",
        "value": "function parameter with default value: 180",
        "file_path": "unknown.js",
        "line_number": 68,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "quality",
        "type": "number",
        "value": "function parameter with default value: 60",
        "file_path": "unknown.js",
        "line_number": 68,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "reject",
        "type": "function",
        "value": "Promise reject callback function",
        "file_path": "controllers/dcimController.js",
        "line_number": 75,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Promise reject callback parameter",
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "req",
        "type": "object",
        "value": "Express request object",
        "file_path": "unknown.js",
        "line_number": 125,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "getImages"
      },
      {
        "name": "res",
        "type": "object",
        "value": "Express response object",
        "file_path": "unknown.js",
        "line_number": 125,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "getImages"
      },
      {
        "name": "resizeOptions",
        "type": "object",
        "value": "{ width: maxSize, height: maxSize, fit: 'inside' }",
        "file_path": "controllers/dcimController.js",
        "line_number": 86,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Options for Sharp image resizing with aspect ratio preservation",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "resolve",
        "type": "function",
        "value": "Promise resolve callback function",
        "file_path": "controllers/dcimController.js",
        "line_number": 75,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Promise resolve callback parameter",
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "screenshotOptions",
        "type": "object",
        "value": "{ timestamps, filename, folder, size }",
        "file_path": "controllers/dcimController.js",
        "line_number": 77,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Options object for FFmpeg screenshots method",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "size",
        "type": "string",
        "value": "`${maxSize}x?`",
        "file_path": "controllers/dcimController.js",
        "line_number": 80,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Size specification for extracted frame with maintained aspect ratio",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "tempFramePath",
        "type": "string",
        "value": "path.join(path.dirname(thumbPath), 'temp-frame.png')",
        "file_path": "controllers/dcimController.js",
        "line_number": 85,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Temporary file path for extracted video frame before processing",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "thumbPath",
        "type": "string",
        "value": "function parameter - output path for generated thumbnail",
        "file_path": "unknown.js",
        "line_number": 68,
        "scope": "parameter",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "timestamps",
        "type": "array",
        "value": "[1]",
        "file_path": "controllers/dcimController.js",
        "line_number": 77,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Array of timestamps (in seconds) to extract frames from video",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      },
      {
        "name": "videoExtensions",
        "type": "array",
        "value": "['.mp4', '.mov', '.avi', '.mkv', '.webm']",
        "file_path": "unknown.js",
        "line_number": 71,
        "scope": "literal",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": null,
        "tags": [],
        "metadata": {},
        "function_name": null
      },
      {
        "name": "webpOptions",
        "type": "object",
        "value": "{ quality }",
        "file_path": "controllers/dcimController.js",
        "line_number": 87,
        "scope": "local",
        "declaration_type": null,
        "mutability": "mutable",
        "is_exported": 0,
        "description": "Options for WebP conversion with quality setting",
        "tags": [],
        "metadata": {},
        "function_name": "generateThumbnail"
      }
    ],
    "relationships": [
      {
        "source": "generateThumbnail",
        "target": "inputPath",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "generateThumbnail",
        "target": "thumbPath",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "generateThumbnail",
        "target": "maxSize",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "generateThumbnail",
        "target": "quality",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "generateThumbnail",
        "target": "fileExtension",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "generateThumbnail",
        "target": "isVideo",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "getImages",
        "target": "req",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "getImages",
        "target": "res",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "getImages",
        "target": "db",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "getImages",
        "target": "images",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "inputPath",
        "target": "path.extname",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "path.extname",
        "target": "toLowerCase",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "toLowerCase",
        "target": "fileExtension",
        "source_type": "function",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "videoExtensions",
        "target": "includes",
        "source_type": "variable",
        "target_type": "function",
        "type": "calls_method_on",
        "relationship_type": "calls_method_on",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "fileExtension",
        "target": "includes",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "includes",
        "target": "isVideo",
        "source_type": "function",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "inputPath",
        "target": "sharp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "thumbPath",
        "target": "sharp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "maxSize",
        "target": "sharp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "quality",
        "target": "sharp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "router.get",
        "target": "getImages",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "router.get",
        "target": "getImage",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "router.post",
        "target": "addImage",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "upload.single",
        "target": "addImage",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "addImage",
        "target": "generateThumbnail",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "convertImage",
        "target": "convertToWebP",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "convertUploadedImage",
        "target": "sharp",
        "source_type": "function",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.5,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": null,
        "metadata": {}
      },
      {
        "source": "new Promise",
        "target": "resolve",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.8,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": "Text definition: new Promise contains resolve",
        "metadata": {}
      },
      {
        "source": "new Promise",
        "target": "reject",
        "source_type": "function",
        "target_type": "variable",
        "type": "contains",
        "relationship_type": "contains",
        "relationship_strength": 0.8,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": "Text definition: new Promise contains reject",
        "metadata": {}
      },
      {
        "source": "Promise",
        "target": "new Promise",
        "source_type": "variable",
        "target_type": "function",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.8,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": "Text definition: Promise calls new Promise",
        "metadata": {}
      },
      {
        "source": "isVideo",
        "target": "Promise",
        "source_type": "variable",
        "target_type": "variable",
        "type": "controls_flow_to",
        "relationship_type": "controls_flow_to",
        "relationship_strength": 0.8,
        "context": null,
        "line_number": null,
        "order_sequence": 1,
        "description": "isVideo boolean controls whether Promise is created",
        "metadata": {}
      },
      {
        "source": "isVideo",
        "target": "ffmpeg",
        "source_type": "variable",
        "target_type": "function",
        "type": "controls_flow_to",
        "relationship_type": "controls_flow_to",
        "relationship_strength": 0.8,
        "context": "Video thumbnail generation",
        "line_number": null,
        "order_sequence": 1,
        "description": "isVideo boolean controls whether ffmpeg is called",
        "metadata": {}
      },
      {
        "source": "inputPath",
        "target": "ffmpeg",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Video processing",
        "line_number": null,
        "order_sequence": 1,
        "description": "Input video file path passed to ffmpeg constructor",
        "metadata": {}
      },
      {
        "source": "ffmpeg",
        "target": "ffmpeg.screenshots",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Video frame extraction",
        "line_number": null,
        "order_sequence": 1,
        "description": "ffmpeg command chains to screenshots method",
        "metadata": {}
      },
      {
        "source": "timestamps",
        "target": "screenshotOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Screenshot options",
        "line_number": null,
        "order_sequence": 1,
        "description": "timestamps is assigned to screenshotOptions.timestamps",
        "metadata": {}
      },
      {
        "source": "filename",
        "target": "screenshotOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Screenshot options",
        "line_number": null,
        "order_sequence": 1,
        "description": "filename is assigned to screenshotOptions.filename",
        "metadata": {}
      },
      {
        "source": "folder",
        "target": "screenshotOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Screenshot options",
        "line_number": null,
        "order_sequence": 1,
        "description": "folder is assigned to screenshotOptions.folder",
        "metadata": {}
      },
      {
        "source": "size",
        "target": "screenshotOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Screenshot options",
        "line_number": null,
        "order_sequence": 1,
        "description": "size is assigned to screenshotOptions.size",
        "metadata": {}
      },
      {
        "source": "screenshotOptions",
        "target": "ffmpeg.screenshots",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Video frame extraction",
        "line_number": null,
        "order_sequence": 1,
        "description": "screenshotOptions object passed to ffmpeg.screenshots method",
        "metadata": {}
      },
      {
        "source": "maxSize",
        "target": "size",
        "source_type": "variable",
        "target_type": "variable",
        "type": "derives_from",
        "relationship_type": "derives_from",
        "relationship_strength": 0.8,
        "context": "Size formatting",
        "line_number": null,
        "order_sequence": 1,
        "description": "size string is derived from maxSize parameter",
        "metadata": {}
      },
      {
        "source": "thumbPath",
        "target": "folder",
        "source_type": "variable",
        "target_type": "variable",
        "type": "derives_from",
        "relationship_type": "derives_from",
        "relationship_strength": 0.8,
        "context": "Path extraction",
        "line_number": null,
        "order_sequence": 1,
        "description": "folder is derived from thumbPath using path.dirname",
        "metadata": {}
      },
      {
        "source": "ffmpeg.screenshots",
        "target": "ffmpeg.on",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Event handling setup",
        "line_number": null,
        "order_sequence": 1,
        "description": "ffmpeg.screenshots chains to event listener setup",
        "metadata": {}
      },
      {
        "source": "endCallback",
        "target": "ffmpeg.on",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Event registration",
        "line_number": null,
        "order_sequence": 1,
        "description": "endCallback passed to ffmpeg.on for 'end' event",
        "metadata": {}
      },
      {
        "source": "errorCallback",
        "target": "ffmpeg.on",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Error handling",
        "line_number": null,
        "order_sequence": 1,
        "description": "errorCallback passed to ffmpeg.on for 'error' event",
        "metadata": {}
      },
      {
        "source": "thumbPath",
        "target": "path.dirname",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Path extraction",
        "line_number": null,
        "order_sequence": 1,
        "description": "thumbPath passed to path.dirname to get directory",
        "metadata": {}
      },
      {
        "source": "path.dirname",
        "target": "path.join",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Path construction",
        "line_number": null,
        "order_sequence": 1,
        "description": "path.dirname result used in path.join",
        "metadata": {}
      },
      {
        "source": "path.join",
        "target": "tempFramePath",
        "source_type": "function",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Path construction",
        "line_number": null,
        "order_sequence": 1,
        "description": "path.join result assigned to tempFramePath",
        "metadata": {}
      },
      {
        "source": "tempFramePath",
        "target": "sharp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Image processing",
        "line_number": null,
        "order_sequence": 1,
        "description": "tempFramePath passed to Sharp for processing",
        "metadata": {}
      },
      {
        "source": "sharp",
        "target": "sharp.resize",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Image processing pipeline",
        "line_number": null,
        "order_sequence": 1,
        "description": "Sharp chains to resize method",
        "metadata": {}
      },
      {
        "source": "sharp.resize",
        "target": "sharp.webp",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Image processing pipeline",
        "line_number": null,
        "order_sequence": 1,
        "description": "resize chains to webp conversion",
        "metadata": {}
      },
      {
        "source": "sharp.webp",
        "target": "sharp.toFile",
        "source_type": "function",
        "target_type": "function",
        "type": "chains_to",
        "relationship_type": "chains_to",
        "relationship_strength": 0.8,
        "context": "Image processing pipeline",
        "line_number": null,
        "order_sequence": 1,
        "description": "webp chains to toFile for saving",
        "metadata": {}
      },
      {
        "source": "resizeOptions",
        "target": "sharp.resize",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Image resizing",
        "line_number": null,
        "order_sequence": 1,
        "description": "resizeOptions passed to Sharp resize method",
        "metadata": {}
      },
      {
        "source": "webpOptions",
        "target": "sharp.webp",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "WebP conversion",
        "line_number": null,
        "order_sequence": 1,
        "description": "webpOptions passed to Sharp webp method",
        "metadata": {}
      },
      {
        "source": "thumbPath",
        "target": "sharp.toFile",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "File output",
        "line_number": null,
        "order_sequence": 1,
        "description": "thumbPath passed to toFile as output destination",
        "metadata": {}
      },
      {
        "source": "tempFramePath",
        "target": "fs.unlinkSync",
        "source_type": "variable",
        "target_type": "function",
        "type": "passes_to",
        "relationship_type": "passes_to",
        "relationship_strength": 0.8,
        "context": "Cleanup",
        "line_number": null,
        "order_sequence": 1,
        "description": "tempFramePath passed to unlinkSync for deletion",
        "metadata": {}
      },
      {
        "source": "maxSize",
        "target": "resizeOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "derives_from",
        "relationship_type": "derives_from",
        "relationship_strength": 0.8,
        "context": "Size configuration",
        "line_number": null,
        "order_sequence": 1,
        "description": "resizeOptions width and height derived from maxSize",
        "metadata": {}
      },
      {
        "source": "quality",
        "target": "webpOptions",
        "source_type": "variable",
        "target_type": "variable",
        "type": "derives_from",
        "relationship_type": "derives_from",
        "relationship_strength": 0.8,
        "context": "Quality configuration",
        "line_number": null,
        "order_sequence": 1,
        "description": "webpOptions quality derived from quality parameter",
        "metadata": {}
      },
      {
        "source": "reject",
        "target": "errorCallback",
        "source_type": "variable",
        "target_type": "variable",
        "type": "assigns_to",
        "relationship_type": "assigns_to",
        "relationship_strength": 0.8,
        "context": "Error handling",
        "line_number": null,
        "order_sequence": 1,
        "description": "reject function assigned as errorCallback",
        "metadata": {}
      },
      {
        "source": "sharp.toFile",
        "target": "resolve",
        "source_type": "function",
        "target_type": "variable",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.8,
        "context": "Promise resolution",
        "line_number": null,
        "order_sequence": 1,
        "description": "toFile success calls resolve to complete Promise",
        "metadata": {}
      },
      {
        "source": "sharp.toFile",
        "target": "reject",
        "source_type": "function",
        "target_type": "variable",
        "type": "calls",
        "relationship_type": "calls",
        "relationship_strength": 0.8,
        "context": "Error handling",
        "line_number": null,
        "order_sequence": 1,
        "description": "toFile error calls reject to fail Promise",
        "metadata": {}
      }
    ]
  }
}